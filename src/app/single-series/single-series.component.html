<app-search-bar (onSearch)="onSearch($event)"></app-search-bar>
<div *ngFor="let data of seriesData | async" class="single-series-view col-xs-12 col-sm-12 col-xl-11">
  <p *ngIf="data.error">Series does not exist.</p>
  <div *ngIf="!data.error">
    <h3 class="series-title">{{data.seriesDetail.title}}</h3>
    <app-geo-selector [regions]="data.regions" [(selectedGeo)]="data.currentGeo" (selectedGeoChange)="redrawGeo($event, data.currentFreq, data.siblings, data.saIsActive)" class="geo-selector"></app-geo-selector>
    <app-freq-selector [freqs]="data.frequencies" [(selectedFreq)]="data.currentFreq" (selectedFreqChange)="redrawFreq($event, data.currentGeo, data.siblings, data.saIsActive)" class="freq-selector"></app-freq-selector>
    <div class="form-check" *ngIf="data.currentFreq.freq !== 'A' && data.currentFreq.freq !== 'S' && data.sibPairs.length > 1">
      <label class="form-check-label">
        <input class="form-check-input" type="checkbox" [checked]="data.saIsActive" (change)="saActive($event, data.currentGeo, data.currentFreq, data.sibPairs)">Seasonally Adjusted
      </label>
    </div>
    <p *ngIf="noSelection">{{noSelection}}</p>
    <p *ngIf="data.noData">{{data.noData}}</p>
    <app-highstock *ngIf="!noSelection && !data.noData" [chartData]="data.chartData" [seriesDetail]="data.seriesDetail"  [currentFreq]="data.currentFreq" [currentGeo]="data.currentGeo" (chartExtremes)="redrawTable($event, data.seriesTableData, data.currentFreq)"></app-highstock>
    <div class="summary-stats" *ngIf="!noSelection && !data.noData && summaryStats">
      <div class="stat">
        <p>Min:</p>{{summaryStats.minValue}}<br>{{summaryStats.minValueDate}}
      </div>
      <div class="stat">
        <p>Max:</p>{{summaryStats.maxValue}}<br>{{summaryStats.maxValueDate}}
      </div>
      <div class="stat">
        <p>{{data.seriesDetail.percent === true ? 'Change ' : '% Change '}}Over Selected Range: </p>{{summaryStats.change}}
      </div>
      <div class="stat">
        <p>Standard Deviation:</p>{{summaryStats.sd}}
      </div>
    </div>
    <p-dataTable *ngIf="!noSelection && !data.noData" [value]="newTableData" scrollable="true">
      <p-column field="tableDate" header="Date" [sortable]="true"></p-column>
      <p-column field="formattedValue" header="Level"></p-column>
      <p-column field="formattedYoy" [header]=data.change></p-column>
    </p-dataTable>
  </div>
</div>